![2pc](https://github.com/caesar-empereur/read-book/blob/master/photo/distri/分布式事务.png)

## 微服务的远程调用与事务的设计
- 保证分布式的服务之间的事务一致性的几种方案
  - 使用分布式事务
  - 使用本地消息表
  - 使用事务消息的最终一致性
    - 最终一致性的方法是没法回滚的，只能一直向前重试或者补偿(定时，人工)
    - 有些业务错误是没办法向前补偿的，例如单据重复之类的，这种需要调用方也要回滚事务

- 分布式事务的2种一致性的方式
    - **[某个服务调用出异常后怎么保证一致性？]()** (保证一致性的2个方式)
        - **[快速失败]()**，某个服务出现异常之后，也就是回滚本地事务
        - **[重试加上补偿措施]()**，本地事务成功后远程调用，调用失败回滚本地事务
    - 每个服务怎么确保与上下游服务的一致性
        - 工程上服务只需要保证与下游的服务的数据一致性就可以了，有异常回滚本地事务
        - 至于与上游的一致性，本事务不用关心，调用失败会返回失败的信息
