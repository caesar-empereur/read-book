## 相同数据库的冷热数据分离
- 哪些场景适合冷热数据分离
  - 数据量庞大
  - 某些数据走到一个状态后，很少进行修改操作
  - 业务方式限制用户只能查询某个时间之前的数据
- 如何使用冷热数据
  - 冷数据用来归档，用户界面限制只能查询操作半年内的数据
  - 正常的业务流程操作的是热数据表，也就是当前的表
  - 业务上限制用户查询跨冷热的数据
  
## 冷热数据分离实施方案
- 冷热分离之前先限制用户只能操作半年内的数据
- 将2亿大表复制2份出来，一份当冷数据表，一份当热数据表
- 将大表根据数据量确定好冷热数据的时间临界点
- 在冷表，将时间点之后的热数据剔除，成为冷数据表
- 在热表，将时间点之前的冷数据删除，成为热数据表
- 在停止对该原来大表写入的适合，将旧大表与新的热数据表表名互换
- 启动定时器，定时将热数据表的新产生的冷数据迁移到冷数据表里，
  冷数据表也可以根据时间分成多个表

## 一些数据统计
- 15个字段，2亿的数据造出来需要12小时左右
- 2亿的数据，数据表的磁盘文件大概有 60 GB
- 复制一个2亿数据的表，大概需要一个小时的时间

- 冷热数据迁移遇到的问题
  - 复制2亿大表的时候报错，出现 The total number of locks exceeds the lock table size
    - 应该是缓冲池的大小或者临时表的大小设置太小了，需要修改
    - 实际测试将  innodb 的缓冲池设置为 5G 大小可以解决这个问题
