## 第二章 操作系统的硬件环境
- 中央处理器
    - 一般的处理机由运算器、控制器、一系列的寄存器以及高速缓存构成
    - 运算器
        - 运算器实现任何指令中的算术和逻辑运算，是计算机计算的核心
    - 控制器
        - 控制器负责控制程序运行的流程，包括取指令、维护处理机状态、处理机与内存的交互等
    - 寄存器
        - 寄存器是指令在处理机内部作处理的过程中暂存数据、地址以及指令信息的存储设备
        - 在计算机的存储系统中具有最快的访问速度
        - 寄存器的种类
            - 用户可见寄存器
                - 用户可见寄存器通常对所有程序都是可用的，由机器语言直接引用
                - 它一般包括数据寄存器、地址寄存器以及条件码寄存器
                - 数据寄存器有时又称通用寄存器，主要用于各种算术逻辑指令和访存指令
                - 地址寄存器用于存储数据及指令的物理地址、线性地址或者有效地址
            - 控制和状态寄存器
                - 它们用于控制处理机的操作，一般由具有特权的操作系统代码使用，以控制其他程序的执行
    - 高速缓存
        - 高速缓存处于处理机和物理内存之间，一般由控制器中的内存管理单元管理
        - 它的访问速度高于内存、低于寄存器
        - 它利用程序局部性原理使得高速指令处理和低速内存访问得以匹配
    - 指令执行的过程
        - 指令读取与指令周期
        ```
        典型的处理机中，每个指令周期开始的时候，处理机依据在程序计数器中保存的指令地址
        从存储器中取一条指令，并在取指令完成后根据指令类别自动将程序计数器的值变成
        下一条指令的地址，通常是自增1。取到的指令被放在处理机的指令寄存器中，
        指令中包含了处理机将要采取的动作的位，处理机于是解释并执行所要求的动作
        ```
        - 指令大致可以分成5类
            - 访问存储器指令，它们负责处理机和存储器之间的数据传送
            - I/O指令，它们负责处理机和I/O模块之间的数据传送和命令发送
            - 算术逻辑指令，又称数据处理指令，用以执行有关数据的算术和逻辑操作
            - 控制转移指令，这种指令可以指定一个新指令的执行起点
            - 处理机控制指令，这种指令用于修改处理机状态

- 存储系统
    - 存储器的类型
    ![2pc](https://github.com/caesar-empereur/read-book/blob/master/photo/os/存储体系结构.png)
    - 缓冲技术
        - 缓冲区是硬件设备之间进行数据传输时，专门用来暂存这些数据的一个存储区域
        - 缓冲区是处理机处理数据速度与设备传输数据速度不相匹配
- 中断
    - 中断的处理流程
        - 所谓中断，是指处理机对系统中或系统外发生的异步事件的响应
        - 异步事件是指无一定时序关系的随机发生的事件，如外围设备完成数据传输，实时控制设备出现异常情况
        - 当这些异步事件发生后，打断了处理机对当前程序的执行，而转去处理该异步事件
        - 直到处理完成之后，再转回原程序的中断点继续执行
    - 为什么要有中断
        - 中断的出现解决了主机和外围设备并行工作的问题
        - 消除了因外围设备的慢速而使得主机等待的现象，提高了可靠性，为多机操作和实时处理提供了硬件基础
    - 现代微机的中断机制
        - 就PC而论，它的微处理机能处理256种不同的中断
        - 发生中断时正在执行的程序的暂停点称为中断断点
        - 处理机暂停当前程序转而处理中断的过程称为中断响应
        - 中断处理结束之后恢复原来程序的执行称为中断返回
    - 中断的种类
        - 按照中断标准区分
            - 程序中断
                - 在某些条件下由指令执行结果产生，例如算术溢出、被零除、试图执行非法指令以及访问不被允许访问的存储位置
            - 时钟中断
                - 图执行非法指令以及访问不
            - I/O中断
                - 由I/O控制器产生，用于通知一个I/O操作的正常完成或者发生的错误
            - 硬件失效中断
                - 由掉电、存储器校验错等硬件故障引起
        - 按照被触发的手段
            - 强迫性中断：是正在运行的程序所不期望发生的，它们出现的随机性比较强
            - 自愿性中断：是正在运行的程序故意安排执行的，通常由访管指令引起，目的是要求操作系统提供系统服务
        - 按照是否异步
            - 异步中断简称中断：异步中断的发生一般是由对当前程序而言的外部事件激发的，属于外源性质
            - 同步中断一般称为异常：异常的发生则是当前程序的编码和逻辑激发的，属于“内因”性质
    - 中断系统
        - 中断系统包括两大组成部分：中断系统的硬件中断装置和软件中断处理程序
        - 硬件中断装置
            - 负责捕获中断源发出的中断请求，并以一定的方式响应中断源
            - 然后将处理机的控制权移交给特定的中断处理程序
        - 中断处理程序
            - 负责辨别中断类型，并根据请求做出相应的操作
    - 硬件中断，软件处理流程
    ![2pc](https://github.com/caesar-empereur/read-book/blob/master/photo/os/中断处理流程.png)

## 第三章 进程与进程管理
- 进程
    - 进程的定义
        - 进程是具有独立功能的可并发执行的程序在一个数据集合上的运行过程
        - 是系统进行资源分配和调度的独立单位
        - 行为的一个规则称为程序，程序在处理机上执行时所发生的活动称为进程
    - 程序与进程的区别
    
    |程序| 进程 |
    |:------|:-----|
    |程序是完成某个特定功能的指令的有序序列，它是一个静态的概念| 进程是程序的一次执行，它是一个动态的概念  |
    |程序则不是 | 进程是系统进行资源分配和调度的一个独立单位 |
    |程序可以作为一种软件资源长期保存 | 进程是程序的一次执行过程。进程是临时的、有生命期的 |
    
    - 进程的5个特征
        - 动态性
            - 进程是执行程序的动态过程，而程序是进程运行的静态文本
            - 进程有一定的生命期。而程序只是一组有序指令的集合
            - 动态性还表现为：它由创建而产生，由调度而执行，因得不到资源而暂停执行，以及由撤销而消亡
        - 并发性
            - 并发性是指多个进程实体同存于内存中，能在一段时间内同时运行
            - 程序是不能并发执行的
        - 独立性
            - 独立性是指进程实体是一个能独立运行的基本单位
            - 也是系统中独立获得资源和独立调度的基本单位
        - 异步性
            - 异步性是指进程按各自独立的、不可预知的速度向前推进
            - 进程按异步方式运行。这一特征将导致程序执行的不可再现性
    - 进程的基本状态及其转换
        - 就绪状态
            - 当进程已分配到除处理机以外的所有必要的资源后，只要能再获得处理机便可立即执行，这时的状态称为就绪状态
            - 在一个系统中，可以有多个进程同时处于就绪状态，通常把这些进程排成一个或多个队列
        - 执行状态
            - 执行状态指进程已获得处理机，其程序正在执行
            - 在单处理机系统中，只能有一个进程处于执行状态
            - 在多处理机系统中，则可能有多个进程处于执行状态
        - 阻塞状态
            - 进程因发生某种事件而暂停执行时的状态为阻塞状态
            - 通常将处于阻塞状态的进程排成一个队列，称为阻塞队列
            - 按阻塞的原因不同而将处于阻塞状态的进程排成多个队列
        - 挂起状态
            - 在不少系统中，进程只有上述3种基本状态，但在另一些系统中，基于某种需要又增加挂起状态
            - 若进程处于执行状态则暂停执行
            - 若进程处于就绪状态则暂不接受调度
            - 父进程常常希望考察和修改子进程或者当要协调各子进程间的活动时要挂起自己的子进程
            - 为了缓解内存紧张的情况，即将内存中处于阻塞状态的进程换至外存上
            - 使进程又处于一种有别于阻塞状态的新状态
        - 进程状态的转换
            ![2pc](https://github.com/caesar-empereur/read-book/blob/master/photo/os/进程状态转换.png)

    - 进程控制块
        - 进程控制块PCB是进程实体的一部分，操作系统是根据PCB来对并发执行的进程进行控制和管理的
        - 在进程的整个生命期中，系统总是通过其PCB对进程进行控制
        - 因为进程控制块PCB经常被系统访问，尤其是被进程调度及分派程序访问，故PCB应常驻内存
    - 进程控制块的信息
        - 进程标识符信息
            - 用于唯一地标识一个进程
        - 处理机状态信息
            - 处理机状态信息主要是由处理机各种寄存器中的内容所组成
            - 当处理机被中断时，所有这些信息都必须保存在被中断进程的PCB中
        - 进程调度信息
            - 进程状态。指明进程的当前状态，可作为进程调度和对换时的依据
            - 进程优先级。用于描述进程使用处理机的优先级别的一个整数
            - 进程调度所需的其他信息。它们与所采用的进程调度算法有关
        - 进程控制信息
            - 程序和数据的地址。它是指该进程的程序和数据所在的内存或外存地址
            - 进程同步和通信机制。它是指实现进程同步和进程通信时所必需的机制，如消息队列指针、信号量等
            - 资源清单。它是一张列出了除处理机外的进程所需的全部资源及已经分配到该进程的资源清单
            - 链接指针。它给出了本进程所在队列中的下一个进程的PCB首地址
