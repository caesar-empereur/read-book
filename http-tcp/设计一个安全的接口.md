## 如何设计一个安全的接口

- 数据加密
    - 对称加密
        - 常见算法有 AES, DES, 有点是计算速度快，缺点是密钥容易泄漏
    - 非对称加密
        - 生成的一对公钥私钥分开保存在客户端服务端，公钥可以公开，私钥自己保存，常见的是RSA算法
    - HTTPS传输方式结合了以上的2种方式
    - **[HTTPS 一定是安全的吗？](#)**
        - **[重放攻击](#)**
        - **[中间人攻击](#)**
            - 在服务端与客户端之间变成一个中间人的校色，假装与双方通信
        - 接口在内部跳转的时候没有加密，容易被篡改
- 数据签名
    - HTTPS 只是在传输阶段完成了数据的加密，而且都在公网上进行加密
    - 但是现在很多服务接口会在内部跳转，这时候的数据是没有加密，容易被篡改的
    - 支付接口的参数中，金额参数是比较容易被篡改的
    ```
    数据签名就是请求方对请求数据通过将参数用私钥签名，生成了一个字符串, 数据跟字符串是对应的，
    这样接收方在验证签名的时候发现数据跟字符串对应不上，就知道数据被篡改了
    ```
- 时间戳机制
    - 数据通过加密，签名之后就算被抓包工具截取了，也无法破解数据的内容
    - 但是可以在拿到这些数据包之后进行恶意请求，也会造成危险后果
    - **[重放攻击](#)** 就是不用破解数据，只需要对数据包重新请求造成破坏性后果
   ```
   因此数据签名的时候加上时间戳参数服务器端会拿到当前时间和消息中的时间相减，
   看看是否在一个固定的时间范围内比如 10S 内, 超过时间就认为无效请求
   ```
- 限流机制
- 黑名单机制

- 支付接口的安全设计
    - 私钥签名，公钥验证签名
    - 公钥加密，私钥解密
