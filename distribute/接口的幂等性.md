### 介绍
* 接口幂等性就是用户对于同一操作发起的一次请求或者多次请求的结果是一致的，不会因为多次点击而产生了副作用
* 简单的说就是对于同样的数据，可多次重复调用

### 哪些需要处理幂等
* 在增删改查4个操作中，删除和查询多次操作结果是一样的，天然的幂等，其他需要处理幂等

### 需要幂等但是接口没处理时的表现
* 订单的重复支付，第一次支付成功了，但是网络原因结果没有返回，调用方多次重试，生成了多个支付扣款
* 创建订单时，相同数据多次点击，结果是创建了多个相同的订单
* 并发与幂等是有区别的，并发是多个线程（用户）同时操作，幂等是一个用户用同样的数据多次连续请求

### 接口幂等性设计思路
```
例如订单支付之类的请求，一定要先查询订单是否支付，是的话直接返回，多次请求只有第一次触发了操作
上面的方式可能会出现并发的脏数据，单机并发加锁就可以，分布式并发需要做成分布式锁，如redis
可以在幂等的接口加上token获取
```
* 重要的接口每次需要先从后台获取到一个token,后台生成并且保存到redis，有效期5分钟
* 请求的时候后台判断token是否过期，没过期流程继续，完成后删掉token
* 下一次重复请求进来判断到token已经失效，直接返回重复请求
* 幂等的关键是重复无效请求的识别，如果是创建订单的数据请求一次后重复请求指定是无效请求，token失效 可以判断出来。如果是客户确实短时间内下了同样商品的订单，那么每次提交订单必须获取token，这样token 也可以处理
* 如果是注册接口，同一个客户无论怎么样只能注册一次，那么就不需要token处理了，将请求的所有数据用hash或者md5算出一个唯一的id，判断到id存在就是无效请求了，id可以放在数据库中
